"use strict";controllerFunc("ngScope","ngController",function(e,t){function o(){t({method:"POST",params:{pIds:n,pageSize:1,pageNum:1,type:9},url:BaseUrl+"product1/searchProductImgList"}).then(function(t){t.data.result===SUCCESS_CODE&&(e.imgPath=t.data.data[0].imgUrl)},function(){console.error("获取订单详情图失败")})}var a=JSON.parse(localStorage.getItem("orderDetailInfo")),n=a.pId,c=a.oMealsId,l=a.adultNum,r=a.childNum,i=a.oldNum,s=a.oTotalDuration,d=a.calTotalPrice,u=a.downPayment,m=a.installmentEachPrice,p=a.totalMoney,g=a.oTotalSxfMoney,y=a.dfcNum,f=a.oTotalDfcMoney,T=a.rCode,h=a.title,D=a.subTitle,N=a.comboName,k=a.installment,I=a.departureDate,S=a.shopNum,b=a.creditMoney,M=getTypeNative();sessionStorage.setItem("rateDes",a.rateDescription),e.goInstallment=function(){go_page("../../pages/travel/travel_installment_contract_text.html",[{flag:"0"},{pId:n}])},e.appType=getTypeNative();var C=document.getElementById("myModal"),v=document.getElementById("myImg"),P=document.getElementById("img01"),E=document.getElementById("caption");v.onclick=function(){C.style.display="block",P.src=this.src,P.alt=this.alt,E.innerHTML=this.alt};var O=document.getElementsByClassName("close")[0];O.onclick=function(){C.style.display="none"},o(),e.agreeDeal=!0,e.clicNum=2,e.pTitle=h,e.subTitle=D,e.downPayment=u,e.comboName=N,e.installment=k,e.departureDate=I,e.shopNum=S,e.creditMoney=b,e.durationMoney=m,e.oTotalDuration=s,e.readDeal=function(t){angular.element(t.target).toggleClass("deal-select"),e.agreeDeal=e.clicNum%2,e.canCreate=!e.agreeDeal,e.clicNum++},e.createOrder=function(){var e={token:getToken(),oPid:n,oMealsId:c,oTicketOldNum:i,oTicketYoungNum:l,oTicketChildrenNum:r,oTotalFirstPrice:u,oTotalPrice:d,oTotalDuration:s,oDurationMoney:m,totalMoney:p,oTotalDfcMoney:f,oTotalSxfMoney:g.toFixed(2),dfcNum:y};T&&function(){e.contractNum=T}(),t({method:"POST",params:e,url:BaseUrl+"order/createOrder/v1"}).then(function(e){e.data.result===SUCCESS_CODE&&(GetQueryString("isPay")?go_page("./travel_checkstand.html",[{page:"combo"},{oId:e.data.oId}]):$(".layer").css("display","block"))},function(){console.error("订单创建失败")})},e.showDialog=function(){e.isDialog={display:"block"},$(".travel-info-cover").on("click",function(){e.$apply(function(){e.isDialog={display:"none"}})})},e.goBack=function(){"android"==M?android.backAccount():"ios"==M?backAccount():window.history.back()},e.promptClose=function(){$(".layer").css("display","none")},e.backAccount=function(){"ios"==e.appType?backAccount():"android"==e.appType?android.backAccount():window.location.href="../../pages/account/user_personal.html"},e.submitOrder=function(){e.agreeDeal&&e.createOrder()}});