"use strict";function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}controllerFunc("ngScope","ngController",function(e,t,a,o){function n(){e.checkUse=!0,g?c():d(),l()}function i(a,o){t({method:"POST",params:{pageSize:"1",type:a,pIds:p,pageNum:o},url:BaseUrl+"product1/searchProductImgList"}).then(function(t){if(console.log(t),console.log(t.data.totalCount>10),t.data.totalCount>10)switch(console.log(t.data.totalCount),a){case"2":if(w)return i(a,t.data.totalCount),void(w=!1);break;case"3":if(F)return i(a,t.data.totalCount),void(F=!1);break;case"4":if(v)return i(a,t.data.totalCount),void(v=!1)}2==a?e.travelList=t.data.data:3==a?e.payList=t.data.data:4==a&&(e.infoList=t.data.data)},function(e){console.error("数据请求失败")})}function s(){function e(e){e.addClass("travel-tab-active"),e.siblings().removeClass("travel-tab-active")}2==h?setTimeout(function(){y=.7*S;for(var t=document.documentElement.getElementsByClassName("info_imgA"),a=0;a<t.length;a++)y+=t[a].offsetHeight;y>50&&$(".swiper-container-content").css("height",y);var o=$(".tab"),n=new Swiper(".swiper-container-content",_defineProperty({direction:"horizontal",scrollbar:".swiper-scrollbar",scrollbarHide:!1,onSlideChangeEnd:function(e){}},"onSlideChangeEnd",function(t){var a=t.activeIndex;if("1"==a){T=.7*S;for(var n=document.documentElement.getElementsByClassName("info_imgB"),i=0;i<n.length;i++)T+=n[i].offsetHeight;$(".swiper-container-content").css("height",T)}else if("2"==a){b=.7*S;for(var s=document.documentElement.getElementsByClassName("info_imgC"),i=0;i<s.length;i++)b+=s[i].offsetHeight;$(".swiper-container-content").css("height",b)}else{y=.7*S;for(var r=document.documentElement.getElementsByClassName("info_imgA"),i=0;i<r.length;i++)y+=r[i].offsetHeight;$(".swiper-container-content").css("height",y)}e(o.eq(t.activeIndex))}));$(o).on("click",function(){var t=$(this).index();if("1"==t){T=.7*S;for(var a=document.documentElement.getElementsByClassName("info_imgB"),i=0;i<a.length;i++)T+=a[i].offsetHeight;$(".swiper-container-content").css("height",T)}else if("2"==t){b=.7*S;for(var s=document.documentElement.getElementsByClassName("info_imgC"),i=0;i<s.length;i++)b+=s[i].offsetHeight;$(".swiper-container-content").css("height",b)}else{y=.7*S;for(var r=document.documentElement.getElementsByClassName("info_imgA"),i=0;i<r.length;i++)y+=r[i].offsetHeight;$(".swiper-container-content").css("height",y)}e(o.eq(t)),n.slideTo(t,1e3,!1)})},200):h++}function r(){var t=[],a=e.pFirstFee||"0";switch(e.fBtype){case"1":"1"===e.fCmethodType?(e.rateDescription="最终手续费=【(订单金额-首付) * 手续费比例】",e.poundage=(e.forTotalMoney-e.pFirstFee)*e.fFee):"2"===e.fCmethodType&&(e.rateDescription="最终手续费=【手续费金额】】",e.poundage=e.fFee);break;case"2":"1"===e.fCmethodType&&"1"===e.fSwayType?(e.rateDescription="最终手续费=【(订单金额-首付) * (手续费比例- 供应商贴息比例)】",e.poundage=(e.forTotalMoney-e.pFirstFee)*(e.fFee-e.fSwayFee)):"1"===e.fCmethodType&&"2"===e.fSwayType&&(e.rateDescription="最终手续费=【(订单金额-首付) * 手续费比例 - 供应商贴补金额】",e.poundage=(e.forTotalMoney-e.pFirstFee)*e.fFee-e.fSwayFee);break;case"3":var o=e.fDuration.split("/"),n=e.fFee.split(","),i=conversion(o),s=conversion(n);if(e.poundages=[],n.length==o.length)for(var r=0;r<o.length;r++)e.poundages[r]=(e.forTotalMoney-e.pFirstFee)*s[r];for(var l=0;l<i.length;l++){var c={},d=e.forTotalMoney-a;e.allTotalMoney=d,c.price=(d/i[l]+e.poundages[l]).toFixed(2),c.fq=i[l],c.pFirstFee=e.pFirstFee,c.poundage=e.poundages[l]/c.fq,c.fFee=s[l],c.initFee=parseInt(100*s[l]),t.push(c)}e.installmentItems=t,e.aomountInstallment=e.installmentItems[i.length-1].price,e.staging=e.installmentItems[i.length-1].fq}if("3"!=e.fBtype){for(var l=0;l<e.fqNum.length;l++){var c={},p=e.forTotalMoney-a;e.allTotalMoney=p,c.price=(p/e.fqNum[l]+e.poundage).toFixed(2),c.fq=e.fqNum[l],c.pFirstFee=e.pFirstFee,c.poundage=e.poundage/c.fq,c.fFee=e.fFee,c.initFee=(100*c.fFee).toPrecision(1),t.push(c)}e.installmentItems=t,e.aomountInstallment=e.installmentItems[e.fqNum.length-1].price,e.staging=e.installmentItems[e.fqNum.length-1].fq}}function l(){t({method:"POST",params:{pId:p},url:BaseUrl+"product1/searchProductDetail"}).then(function(t){e.siKefuMobile=t.data.data.siKefuMobile,e.pTotalMoney=formatNum(t.data.data.pTotalMoney),e.pYoungMoney=formatNum(t.data.data.pYoungMoney),e.departureMonth=t.data.data.departureMonth.replace(/,/g,"、"),e.pTitle=t.data.data.pTitle;var a=t.data.data.fDuration;e.fDuration=a.replace(/,/g,"/"),e.pTitleSub=t.data.data.pTitleSub,e.salesCount=t.data.data.saleCount,e.images=t.data.imageData,e.status=t.data.data.status,m=e.status,"1"==e.status?$(".col").html("&#xe650;").css("color","#ebc223"):$(".col").html("&#xe683;").css("color","#ffff"),e.fBtype=t.data.fDurationData.fBtype,e.fCmethodType=t.data.fDurationData.fCmethodType,e.fFee=t.data.fDurationData.fFee,e.fSwayType=t.data.fDurationData.fSwayType,e.pFirstFee=toDecimal2(t.data.data.pFirstFee),e.myFistFee=parseInt(e.pFirstFee),e.pFirstFee=parseInt(e.pFirstFee),e.fSwayFee=t.data.fDurationData.fSwayFee,e.fqNum=a.split(",");var o=e.fqNum.length;e.forTotalMoney=parseFloat(e.pYoungMoney.replace(/,/g,"")),e.fenNum=o,r(),setTimeout(function(){e.initBanner()},500),e.toPage=function(o){g?"ios"===e.appType?window.webkit?e.checkUse?window.webkit.messageHandlers.uploadContract.postMessage({pId:p,installment:a,pTitle:e.pTitle,subTitle:e.pTitleSub}):window.webkit.messageHandlers.realNameAuthentication.postMessage({token:g}):e.checkUse?uploadContract(p,a,e.pTitle,e.pTitleSub):realNameAuthentication(g):"android"===e.appType?e.checkUse?android.uploadContract(p,a,e.pTitle,e.pTitleSub):android.realNameAuthentication(g):e.checkUse?go_page("./travel_upload_contract.html",[{pId:p},{fDuration:t.data.data.fDuration},{pTitle:t.data.data.pTitle},{pTitleSub:t.data.data.pTitleSub},{isQianyue:"1"}]):go_page("./travel_upload_cdCard.html"):go_page("../account/user_login.html",[{toUrl:window.location.href}])},e.hideDialog=function(){$("#travel-choose-dialog").css("display","none")},e.toPage1=function(e){switch(e){case"取消":$("#travel-choose-dialog").css("display","none");break;case"未签约":go_page("./travel_choose_product.html",[{pId:p},{signing:!0},{installment:t.data.data.fDuration},{pTitle:t.data.data.pTitle},{pTitleSub:t.data.data.pTitleSub}])}}},function(e){console.error("数据请求失败")})}function c(){t({method:"POST",params:{token:g},url:BaseUrl+"members/searchRealNameStatus"}).then(function(t){t.data.result==SUCCESS_CODE&&(0==t.data.status||0==t.data.accountStatus)&&(e.checkUse=!1),d()})}function d(){e.goBack=function(){u?"ios"==e.appType?backHome():"android"==e.appType&&android.backHome():GetQueryString2("isLogin")&&1==GetQueryString2("isLogin")?"ios"==e.appType?backHome():"android"==e.appType?android.backHome():toIndex():"ios"==e.appType?backHome():"android"==e.appType?android.backHome():window.history.back()},e.reservePro=function(){e.nowSubmit&&(g?e.checkUse?(e.dialogInfo="已签订旅游合同开始上传",e.dialogDown="未签约"):(e.dialogInfo="前往实名认证",e.dialogDown="取消"):(e.dialogInfo="还没登录,立即登录",e.dialogDown="取消"),$("#detailMenu").animateCss("fadeInUp"),$("#travel-choose-dialog").css("display","block"))},e.shareDetail=function(){switch(e.appType){case"android":android.fenqihuiShare();break;case"ios":fenqihuiShare();break;case"weixin":break;default:e.dialogObj.conetent.innerHTML="请在微信中使用此功能",e.dialogObj.show()}}}e.dialogObj=new Dialog(DIALOG_DIALOG),e.dialog=!1,e.msg="",e.isMsg=!0,e.isShelter=!1;var p=GetQueryString("pId"),u=GetQueryString("sourcePage")||"",f=GetQueryString("ps");e.nowSubmit=!0,("pi"==f||f)&&(e.nowSubmit=!1),e.appType=getTypeNative();var g=getToken(),m="2",h=0;"ios"==e.appType&&$("#travel_detail_guideNav").css("top","30px"),n(),e.renderFinish=function(){s()},e.initBanner=function(){new Swiper(".swiper-container",{direction:"horizontal",autoplay:5e3,loop:!0,pagination:".swiper-pagination",observer:!0,observeParents:!0});e.$apply(function(){e.dialog=!1})},i("2","10"),i("3","10"),i("4","10");var y,T,b,w=!0,F=!0,v=!0,S=parseFloat(document.getElementsByTagName("html")[0].style.fontSize);e.$watch("msg",function(t,o){a(function(){e.isMsg=!0},1e3,!0)},!1),e.telPhone=function(){var t=getTypeNative();"android"==t?android.callPhone(e.siKefuMobile):"ios"==t&&callPhone(e.siKefuMobile)},e.collection=function(){g?"0"==m?t({method:"POST",url:BaseUrl+"product1/addProductCollection",params:{token:getToken(),pId:p}}).then(function(t){m="1",e.msg="收藏"+t.data.message,e.isMsg=!1,$(".col").html("&#xe650;").css("color","#ebc223")},function(){e.msg="收藏失败",e.isMsg=!1}):(m="0",t({method:"POST",url:BaseUrl+"product1/cancelProductCollection",params:{token:getToken(),pId:p}}).then(function(t){e.msg="取消"+t.data.message,e.isMsg=!1,$(".col").html("&#xe683;").css("color","#fff")},function(){e.msg="取消失败",e.isMsg=!1})):(e.dialogInfo="还没登录,立即登录",e.dialogDown="取消",$("#detailMenu").animateCss("fadeInUp"),$("#travel-choose-dialog").css("display","block"))},e.closeStag=function(){e.isShelter=!1},e.showLayer=function(){e.isShelter=!0}});