"use strict";controllerFunc("userForgetPayPassword","userForgetPayPasswordController",function(e,o,s,t){function r(o,t){e.isMsg=!1,e.pro_text=o,s(function(){e.isMsg=!0},1e3)}e.resultPhone=!1,e.resultCode=!1,e.resultTime=!1,e.getCodeClick=!0,e.click=!1,e.isSetPasswod=!1;var n="";e.blurPhone=function(){e.checkPhone(),e.resultPhone&&(e.msg="")},e.isMsg=!0,e.checkPhone=function(){var o=/^(0|86|17951)?(13[0-9]|15[012356789]|17[0-9]|18[0-9]|14[0-9])[0-9]{8}$/;return""==e.phoneNum||null==e.phoneNum?(e.resultPhone=!1,r("手机号不能为空！"),!1):o.test(e.phoneNum)?(e.resultPhone=!0,!0):(e.resultPhone=!1,r("手机号输入有误"),!1)},e.backTime=function(o){var s=o,t=setInterval(function(){s--,$("#getCode-button").val("重发("+s+")").attr("disabled","disabled").css("background","#ccc"),0>=s&&(clearInterval(t),$("#getCode-button").val("重新发送").removeAttr("disabled").css("background","#ef6f00"),e.getCodeClick=!0)},1e3)},e.getCodePay=function(){return e.checkPhone(),e.resultPhone&&e.getCodeClick&&(e.getCodeClick=!1,e.getCodePortPay()),!0},e.getCodePortPay=function(){o({method:"POST",url:BaseUrl+"members/PhoneValidate",params:{phoneNum:e.phoneNum,type:"5",token:getToken()}}).success(function(o){switch(o.result){case"0000":e.backTime(60),e.click=!0,r("发送短信成功");break;case"9999":r("发送短信失败"),e.getCodeClick=!0;break;case"9998":r("系统异常"),e.getCodeClick=!0;break;case"1001":r("手机号无效"),e.getCodeClick=!0;break;case"1002":r("手机号已经被注册"),e.getCodeClick=!0;break;case"1005":r("用户不存在"),e.getCodeClick=!0;break;case"1007":r("输入手机号与注册时的手机号码不匹配!"),e.getCodeClick=!0;break;default:e.getCodeClick=!0}}).error(function(){r("网络忙")})},e.codeUp=function(){e.click&&e.checkPhone()&&(6==e.userCode.length&&"null"!=e.userCode?($(".register-now ").removeClass("gray").addClass("blue"),e.isSetPasswod=!0):($(".register-now ").removeClass("blue").addClass("gray"),e.isSetPasswod=!1))},e.checkCode=function(){e.userCode||(e.userCode=""),e.userCode+="";var o=e.userCode+"";""==o||null==o?(r("验证码不能为空！"),e.resultCode=!1):o.length<6?r("验证码错误"):e.resultCode=!0},e.changePassword=function(){e.isSetPasswod&&(e.checkCode(),e.resultPhone&&e.resultCode?o({method:"POST",params:{token:getToken(),mobile:e.phoneNum,code:e.userCode},url:BaseUrl+"account/toValiaMassage"}).success(function(e){"0000"==e.result?window.location.href="../../pages/account/user_modify_password_confirm.html":"1102"==e.result?r("验证码输入有误或过期"):(n="网络异常",r(n))}).error(function(){n="网络异常",r(n)}):(n=e.resultPhone?"验证码输入错误":"手机号输入错误",r(n)))}});