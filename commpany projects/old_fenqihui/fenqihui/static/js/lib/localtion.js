"use strict";!function(e,t){return"function"==typeof define&&define.amd?void define("ngStorage",["angular"],function(e){return t(e)}):t(e)}("undefined"==typeof angular?null:angular,function(e){function t(t){return["$rootScope","$window","$log","$timeout",function(o,n,r,a){function i(e){var t=n[e];if(t&&"localStorage"===e){var o="__"+Math.round(1e7*Math.random());try{localStorage.setItem(o,o),localStorage.removeItem(o)}catch(r){t=!1}}return t}var c,u,l=i(t)||(r.warn("This browser does not support Web Storage!"),{setItem:function(){},getItem:function(){}}),f={$default:function(t){for(var o in t)e.isDefined(f[o])||(f[o]=t[o]);return f},$reset:function(e){for(var t in f)"$"===t[0]||delete f[t]&&l.removeItem("ngStorage-"+t);return f.$default(e)}};try{l=n[t],l.length}catch(s){r.warn("This browser does not support Web Storage!"),l={}}for(var g,d=0,S=l.length;S>d;d++)(g=l.key(d))&&"ngStorage-"===g.slice(0,10)&&(f[g.slice(10)]=e.fromJson(l.getItem(g)));return c=e.copy(f),o.$watch(function(){var t;u||(u=a(function(){if(u=null,!e.equals(f,c)){t=e.copy(c),e.forEach(f,function(o,n){e.isDefined(o)&&"$"!==n[0]&&l.setItem("ngStorage-"+n,e.toJson(o)),delete t[n]});for(var o in t)l.removeItem("ngStorage-"+o);c=e.copy(f)}},100,!1))}),"localStorage"===t&&n.addEventListener&&n.addEventListener("storage",function(t){"ngStorage-"===t.key.slice(0,10)&&(t.newValue?f[t.key.slice(10)]=e.fromJson(t.newValue):delete f[t.key.slice(10)],c=e.copy(f),o.$apply())}),f}]}e.module("ngStorage",[]).factory("$localStorage",t("localStorage")).factory("$sessionStorage",t("sessionStorage"))});