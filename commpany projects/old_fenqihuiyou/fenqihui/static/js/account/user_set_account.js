"use strict";controllerFunc("userSetAccount","userSetAccountController",function(e,t){e.msg="",e.resultPhone=!1,e.resultCode=!1,e.resultTime=!1,e.getCodeClick=!0,e.codestate=!1,e.resultPassword=!1,e.blurPhone=function(){e.checkPhone(),e.resultPhone&&(e.msg="")},e.checkPhone=function(){var t=/^(0|86|17951)?(13[0-9]|15[012356789]|17[0-9]|18[0-9]|14[0-9])[0-9]{8}$/;return""==e.phoneNum||null==e.phoneNum?(e.resultPhone=!1,void(e.msg="* 手机号不能为空！")):t.test(e.phoneNum)?void(e.resultPhone=!0):(e.resultPhone=!1,void(e.msg="* 手机号输入错误！"))},e.backTime=function(t){var o=t,s=setInterval(function(){o--,$("#getCode-button").val("重发("+o+")").attr("disabled","disabled").css("background","#AAAAAA"),0>=o&&(clearInterval(s),$("#getCode-button").val("重新发送").removeAttr("disabled").css("background","#ebc023"),e.getCodeClick=!0)},1e3)},e.getCodeRegister=function(){e.checkPhone(),e.resultPhone&&e.getCodeClick&&(e.msg="",e.getCodeClick=!1,e.getCodePortRegister())},e.getCodePortRegister=function(){t({method:"POST",url:BaseUrl+"members/PhoneValidate",params:{phoneNum:e.phoneNum,type:"1"}}).success(function(t){switch(e.codestate={display:"block"},setTimeout(function(){e.$apply(function(){e.codestate={display:"none"}})},1e3),t.result){case"0000":e.state="发送成功",e.backTime(60);break;case"9999":e.state="发送短信失败",e.getCodeClick=!0;break;case"9998":e.state="系统异常",e.getCodeClick=!0;break;case"1001":e.state="手机号无效",e.getCodeClick=!0;break;case"1002":e.state="手机号已经被注册",e.getCodeClick=!0;break;case"1005":e.state="用户不存在",e.getCodeClick=!0;break;default:e.getCodeClick=!0}})},e.getCodeFind=function(){e.checkPhone(),e.resultPhone&&e.getCodeClick&&(e.msg="",e.getCodeClick=!1,e.getCodePortFind())},e.getCodePortFind=function(){t({method:"POST",url:BaseUrl+"/members/PhoneValidate",params:{phoneNum:e.phoneNum,type:"3",token:getToken()}}).success(function(t){switch(e.codestate={display:"block"},setTimeout(function(){e.$apply(function(){e.codestate={display:"none"}})},1e3),t.result){case"0000":e.state="发送成功",e.backTime(60);break;case"9999":e.state="发送短信失败",e.getCodeClick=!0;break;case"1001":e.state="手机号无效",e.getCodeClick=!0;break;case"1002":e.state="手机号已经被注册",e.getCodeClick=!0;break;case"1005":e.state="用户不存在",e.getCodeClick=!0;break;default:e.getCodeClick=!0}})},e.blurCode=function(){e.checkCode(),e.resultCode&&(e.msg="")},e.checkCode=function(){return""==e.userCode||null==e.userCode?(e.msg="* 验证码不能为空！",void(e.resultCode=!1)):void(e.resultCode=!0)},e.blurPassword=function(){e.checkPassword(),e.resultPassword&&(e.msg="")},e.checkPassword=function(){var t=/^([a-z]|[A-Z]|[0-9]){6,16}$/;return""==e.userPassword||null==e.userPassword?(e.msg="* 密码不能为空！",void(e.resultPassword=!1)):t.test(e.userPassword)?void(e.resultPassword=!0):(e.msg="* 密码错误，请输入6-16位数字字母组合密码！",void(e.resultPassword=!1))},e.setPassword=function(){e.resultPhone&&e.resultCode&&e.resultPassword&&t({method:"POST",url:BaseUrl+"members/setLoginPwd",params:{token:getToken(),password:e.userPassword,smsCode:e.userCode,phoneNum:e.phoneNum}}).success(function(e){"0000"===e.result&&(alert("设置密码成功"),window.location.href="/user_login.html?v="+Math.random())}).error(function(e){})}});