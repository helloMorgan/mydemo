"use strict";controllerFunc("userRegisterAccount","userRegisterAccountController",function(e,t,o){function s(){if("ios"==n)goLogin();else if("android"===n)android.goLogin();else{var e=window.location.href=getAbsolutePath()+"/fenqihui/pages/account/user_login.html";go_page(e,[{toUrl:window.location.href}])}}function r(t,r){o(function(){t.length>10?($(".prompt_box>p").css("font-size",".8rem"),e.$apply(function(){e.pro_text=t})):($(".prompt_box>p").css("font-size","1rem"),e.$apply(function(){e.pro_text="亲，"+t}))},100),$("#layer").css("display","block"),$(".close_btn").click(function(){r&&s(),$("#layer").css("display","none")})}$(".swap_eye").bind("click",function(){var e=$(".swap_eye .eye_img")[0].src.match(/\/(\w+\.(?:png))$/i)[1];"open_eyes.png"==e?($(".swap_eye .eye_img").css("height",".875rem"),$(".swap_eye .eye_img").attr("src","../../static/bitmap/account/close_eyes.png"),$(".basic_password").attr("type","password")):($(".swap_eye .eye_img").css("height","1.3rem"),$(".swap_eye .eye_img").attr("src","../../static/bitmap/account/open_eyes.png"),$(".basic_password").attr("type","text"))}),$("input").focus(function(){$("footer").hide()});var c=!0;e.backTime=function(t){var o=$(".sms-bg");if(!c)return!1;c=!1;var s=setInterval(function(){t--,o.html("重发  "+t+"秒"),0==t&&(clearInterval(s),o.html("重新获取"),c=!0,e.getCodeClick=!1)},1e3)},e.isPhone=!1,e.isSms=!1,e.isPass=!1,e.prompt_text="",e.getCodeClick=!1,e.isClick=!1,e.flag=!1;var n=getTypeNative();e.checkPhone=function(){var t=e.phone+"";if(null==t||0==t.length)return e.prompt_text="请输入手机号码！",e.isPhone=!0,!1;if(11!=t.length)return e.prompt_text="请输入有效的手机号码！",e.isPhone=!0,!1;var o=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return o.test(t)?!0:(e.prompt_text="请输入有效的手机号码！",e.isPhone=!0,!1)},e.$watch("password",function(t,o){t!=o&&e.isClick&&e.checkPhone()&&e.checkSms()&&(t.length>5?($(".btn").removeClass("gray").addClass("blue"),e.flag=!0):($(".btn").removeClass("blue").addClass("gray"),e.flag=!1))}),e.checkSms=function(){var t=e.sms+"";return t.length<6?(e.isSms=!0,e.prompt_text="请输入验证码",!1):!0},e.checkPassword=function(){var t=e.password+"";return t.length<6?(e.isPass=!0,e.prompt_text="请输入密码",!1):e.isClick&&e.getCodeClick?!0:!1},e.getSmsCode=function(){e.checkPhone(),e.isClick=!0,e.checkPhone()&&!e.getCodeClick&&e.getCodePortSms()},e.getCodePortSms=function(){t({method:"POST",url:BaseUrl+"members/PhoneValidate",params:{phoneNum:e.phone,type:"3",token:getToken()}}).success(function(t){switch(t.result){case"0000":e.prompt_text="发送成功",e.backTime(60),e.getCodeClick=!0;break;case"1007":e.prompt_text="输入手机号与注册手机号码不匹配!",$(".prompt_box>p").css("font-size",".7rem"),e.backTime(60),r(e.prompt_text),e.getCodeClick=!1;break;case"9999":e.prompt_text="发送短信失败",r(e.prompt_text),e.getCodeClick=!1;break;case"9998":e.prompt_text="系统异常",r(e.prompt_text),e.getCodeClick=!1;break;case"1001":e.prompt_text="手机号无效",r(e.prompt_text),e.getCodeClick=!1;break;case"1002":e.prompt_text="手机号已经被注册",r(e.prompt_text),e.getCodeClick=!1;break;case"1005":e.prompt_text="用户不存在",r(e.prompt_text),e.getCodeClick=!1;break;default:e.getCodeClick=!1}})},e.setPassword=function(){e.flag&&(e.checkPhone()&&e.checkSms()&&e.checkPassword()&&e.getCodeClick&&!(e.password.length<6)?t({method:"POST",params:{token:getToken(),password:e.password,smsCode:e.sms,phoneNum:e.phone},url:BaseUrl+"members/setLoginPwd"}).success(function(t){switch(t.result){case"0000":var o="../../pages/account/user_login.html";r("密码修改成功",o);break;case"1006":e.prompt_text="密码与支付密码不能相同",r(e.prompt_text);break;case"1102":e.prompt_text="手机验证码不正确或已过期",r(e.prompt_text);break;case"9999":e.prompt_text="网络加载失败，请重试",r(e.prompt_text);break;default:s()}}):r("输入有误"))}});