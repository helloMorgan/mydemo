"use strict";var app=angular.module("myApp",[]);app.controller("myCtrl",["$scope","$http",function(e,t){e.msg="",e.register={display:"none"},e.resultPhone=!1,e.resultPassword=!1,e.resultCode=!1,e.resultTime=!1,e.getCodeClick=!0,e.isReadDeal=!0,e.app=getTypeNative(),e.codestate=!1,e.clearInput=function(t){e.phoneNum=""},e.clearShow={display:"block"},e.clearHidden={display:"none"},e.agreeDeal=function(){e.isReadDeal=!e.isReadDeal},e.toRealName=function(){var t=getToken();e.app?"ios"===e.app?window.webkit?window.webkit.messageHandlers.realNameAuthentication.postMessage({token:t}):realNameAuthentication(getToken()):"android"===e.app?android.realNameAuthentication(getToken()):"weixin"===e.app&&go_page("../travel/travel_upload_cdCard.html"):go_page("../../pages/recommended/recommended_index.html")},e.blurPhone=function(){e.checkPhone(),e.resultPhone&&(e.msg="")},e.checkPhone=function(){var t=/^(0|86|17951)?(13[0-9]|15[012356789]|17[0-9]|18[0-9]|14[0-9])[0-9]{8}$/;return""==e.phoneNum||null==e.phoneNum?(e.resultPhone=!1,void(e.msg="* 手机号不能为空！")):t.test(e.phoneNum)?void(e.resultPhone=!0):(e.resultPhone=!1,void(e.msg="* 手机号输入错误！"))},e.backTime=function(t){var s=t,o=setInterval(function(){s--,$("#getCode-button").val("重发("+s+")").attr("disabled","disabled").css("background","#AAAAAA"),0>=s&&(clearInterval(o),$("#getCode-button").val("重新发送").removeAttr("disabled").css("background","#ebc023"),e.getCodeClick=!0)},1e3)},e.getCodeRegister=function(){e.checkPhone(),e.resultPhone&&e.getCodeClick&&(e.msg="",e.getCodeClick=!1,e.getCodePort("1"))},e.getCodePort=function(s){t({method:"POST",url:BaseUrl+"members/PhoneValidate",params:{phoneNum:e.phoneNum,type:s}}).then(function(t){switch(e.codestate={display:"block"},setTimeout(function(){e.$apply(function(){e.codestate={display:"none"}})},1e3),t.data.result){case"0000":e.state="发送成功",e.backTime(60);break;case"9999":e.state="发送短信失败",e.getCodeClick=!0;break;case"9998":e.state="系统异常",e.getCodeClick=!0;break;case"1001":e.state="手机号无效",e.getCodeClick=!0;break;case"1002":e.state="手机号已经被注册",e.getCodeClick=!0;break;case"1005":e.state="用户不存在",e.getCodeClick=!0;break;default:e.getCodeClick=!0}},function(){alert("网络异常！")})},e.getCodeFind=function(){e.checkPhone(),e.resultPhone&&e.getCodeClick&&(e.msg="",e.getCodeClick=!1,e.getCodePort("4"))},e.blurPassword=function(){e.checkPassword(),e.resultPassword&&(e.msg="")},e.checkPassword=function(){var t=/^([a-z]|[A-Z]|[0-9]){6,16}$/;return""==e.userPassword||null==e.userPassword?(e.msg="* 密码不能为空！",void(e.resultPassword=!1)):t.test(e.userPassword)?void(e.resultPassword=!0):(e.msg="* 密码错误，请输入6-16位数字字母组合密码！",void(e.resultPassword=!1))},e.blurCode=function(){e.checkCode(),e.resultCode&&(e.msg="")},e.checkCode=function(){return""==e.userCode||null==e.userCode?(e.msg="* 验证码不能为空！",void(e.resultCode=!1)):void(e.resultCode=!0)},e.passwordEye=function(e){"password"==$(".login-eye").prev().attr("type")?($(".login-eye").prev().attr("type","text"),$(".login-eye").html("&#xe634;").css("color","#EC6700")):($(".login-eye").prev().attr("type","password"),$(".login-eye").html("&#xe621;").css("color","#2b677b"))},e.registerNow=function(){e.isReadDeal?(e.checkPassword(),e.checkCode(),e.checkPhone(),(e.resultPhone=1==e.resultCode&&1==e.resultPassword)?(e.msg="",e.register={display:"block"},$(".register-shelter").animateCss("bounceInDown")):e.register=!1):(e.codestate={display:"block"},e.state="请先阅读协议",setTimeout(function(){e.$apply(function(){e.codestate={display:"none"}})},1e3))},e.shelterHidden=function(){e.register={display:"none"}},e.registerSuccess=function(){var s={phoneNum:e.phoneNum,password:e.userPassword,code:e.userCode,from:"3"};t({method:"POST",url:BaseUrl+"/members/regist",params:s}).success(function(t){switch(e.codestate={display:"block"},setTimeout(function(){e.$apply(function(){e.codestate={display:"none"}})},1e3),t.result){case"1001":e.state="手机号无效",e.register={display:"none"};break;case"1002":e.state="该手机号已被注册",e.register={display:"none"};break;case"1003":e.state="请输入6-16位长度密码",e.register={display:"none"};break;case"1102":e.state="验证码输入有误或过期",e.register={display:"none"};break;case"0000":e.state="注册成功,正在跳转中...",1==status&&1==accountStatus&&go_page("../../pages/recommended/recommended_index.html"),e.register={display:"none"},localStorage.removeItem("fqhy_token"),localStorage.setItem("fqhy_token",t.token),setTimeout(function(){e.app?"ios"===e.app?backHome():"android"===e.app&&android.backHome():go_page("../../pages/recommended/recommended_index.html")},1e3);break;default:e.state="未知错误，请重新注册！",e.register={display:"none"}}})},e.findPassword=function(){if(e.checkPassword(),e.checkCode(),e.checkPhone(),e.resultPhone=1==e.resultCode&&1==e.resultPassword){e.msg="";var s={phoneNum:e.phoneNum,password:e.userPassword,smsCode:e.userCode};t({method:"POST",url:BaseUrl+"/members/updateLoginPwd",params:s}).success(function(t){switch(e.codestate={display:"block"},setTimeout(function(){e.$apply(function(){e.codestate={display:"none"}})},1e3),t.result){case"1102":e.state="手机验证码不正确或已过期";break;case"1005":e.state="用户不存在";break;case"1006":e.state="密码与支付密码不能相同";break;case"9999":e.state="失败（系统内部错误）";break;case"0000":e.state="密码修改成功",setTimeout(function(){window.location.href="../../pages/account/user_login.html"},1e3)}})}}}]);